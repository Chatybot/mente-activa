<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <!-- Meta tags para PWA (App Nativa) -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Enfoque Mental">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#F5F5DC">
    
    <!-- Icono Sobrio (Br√∫jula de Enfoque) -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><circle cx=%2250%22 cy=%2250%22 r=%2245%22 fill=%22%23004080%22/><path d=%22M50 20 L60 50 L50 80 L40 50 Z%22 fill=%22white%22/></svg>">

    <title>Entrenamiento de Agilidad Mental</title>
    <style>
        :root {
            --bg-color: #F8F5F0; /* Crema neutro profesional */
            --text-color: #2C3E50; /* Gris azulado oscuro */
            --accent-color: #1A5276; /* Azul Oxford */
            --btn-bg: #21618C;
            --success: #1E8449;
            --font-main: 'Helvetica Neue', Arial, sans-serif;
        }

        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
            touch-action: manipulation;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: var(--font-main);
            display: flex;
            flex-direction: column;
            height: 100vh;
            width: 100vw;
            overflow: hidden;
        }

        /* Encabezado */
        header {
            padding: 20px 10px;
            text-align: center;
            border-bottom: 1px solid #D5DBDB;
        }

        h1 { font-size: 28px; margin: 0; font-weight: 300; letter-spacing: 1px; }
        p { font-size: 20px; line-height: 1.4; color: #566573; }

        /* Botonera Principal */
        .btn-large {
            min-height: 90px;
            width: 85%;
            max-width: 450px;
            margin: 12px auto;
            background-color: var(--btn-bg);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 24px;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            box-shadow: 0 4px #154360;
            cursor: pointer;
            transition: all 0.1s;
        }

        .btn-large:active {
            transform: translateY(3px);
            box-shadow: 0 1px #154360;
        }

        /* Pantallas */
        .screen {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            width: 100%;
            padding: 20px;
        }

        .active { display: flex; }

        /* Gu√≠a de Voz */
        .voice-btn {
            background-color: #EBEDEF;
            color: var(--text-color);
            font-size: 18px;
            margin-bottom: 30px;
            padding: 12px 20px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
            border: 1px solid #BDC3C7;
            width: fit-content;
        }

        /* Juego 1: Memoria Visual (Formas Geom√©tricas) */
        .grid-memory {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            width: 100%;
            max-width: 350px;
        }

        .card {
            height: 120px;
            background-color: var(--accent-color);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: 0.3s;
        }

        .card svg { width: 60px; height: 60px; opacity: 0; }
        .card.flipped { background-color: white; border: 3px solid var(--accent-color); }
        .card.flipped svg { opacity: 1; }

        /* Feedback y Overlays */
        #feedback-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg-color);
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 30px;
            text-align: center;
        }

        .status-icon { font-size: 80px; margin-bottom: 20px; }
        .nav-back {
            position: absolute;
            top: 25px; left: 20px;
            padding: 10px 15px;
            background: white;
            border: 1px solid #BDC3C7;
            border-radius: 8px;
            font-size: 18px;
            font-weight: bold;
        }
    </style>
</head>
<body>

    <!-- Men√∫ de Selecci√≥n -->
    <div id="home-screen" class="screen active">
        <header>
            <h1>SISTEMA DE ENFOQUE</h1>
            <p>Seleccione un m√≥dulo de entrenamiento</p>
        </header>
        <div style="width: 100%; display: flex; flex-direction: column; margin-top: 20px;">
            <button class="btn-large" onclick="startGame('memory')">Retenci√≥n Visual</button>
            <button class="btn-large" onclick="startGame('agility')">An√°lisis Num√©rico</button>
            <button class="btn-large" onclick="startGame('association')">L√≥gica y Categor√≠a</button>
        </div>
    </div>

    <!-- √Årea de Juego -->
    <div id="game-screen" class="screen">
        <button class="nav-back" onclick="showHomeScreen()">Atr√°s</button>
        <h2 id="game-title" style="margin-top: 50px; font-weight: 400;">Cargando...</h2>
        <button class="voice-btn" onclick="readInstructions()">
            <span>üîä</span> Gu√≠a por voz
        </button>
        <div id="game-area" style="width:100%; display:flex; flex-direction:column; align-items:center;"></div>
    </div>

    <!-- Resultados -->
    <div id="feedback-overlay">
        <div id="feedback-content"></div>
        <button class="btn-large" id="feedback-btn" style="margin-top: 40px;">Continuar</button>
    </div>

    <script>
        const gameArea = document.getElementById('game-area');
        const gameTitle = document.getElementById('game-title');
        const overlay = document.getElementById('feedback-overlay');
        const feedbackContent = document.getElementById('feedback-content');
        const feedbackBtn = document.getElementById('feedback-btn');

        let currentGame = '';
        let instructions = '';

        // Formas Geom√©tricas para Memoria (SVG para evitar emojis infantiles)
        const shapes = [
            '<svg viewBox="0 0 100 100"><circle cx="50" cy="50" r="40" fill="#2E86C1"/></svg>',
            '<svg viewBox="0 0 100 100"><rect x="20" y="20" width="60" height="60" fill="#E67E22"/></svg>',
            '<svg viewBox="0 0 100 100"><path d="M50 15 L85 85 L15 85 Z" fill="#28B463"/></svg>',
            '<svg viewBox="0 0 100 100"><path d="M50 10 L90 50 L50 90 L10 50 Z" fill="#884EA0"/></svg>'
        ];

        function readInstructions() {
            const utterance = new SpeechSynthesisUtterance(instructions);
            utterance.lang = 'es-ES';
            utterance.rate = 0.85;
            window.speechSynthesis.cancel();
            window.speechSynthesis.speak(utterance);
        }

        function showHomeScreen() {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById('home-screen').classList.add('active');
            window.speechSynthesis.cancel();
        }

        function startGame(type) {
            currentGame = type;
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById('game-screen').classList.add('active');
            gameArea.innerHTML = '';
            
            if (type === 'memory') setupMemoryGame();
            else if (type === 'agility') setupAgilityGame();
            else if (type === 'association') setupAssociationGame();
        }

        function setupMemoryGame() {
            gameTitle.innerText = "M√≥dulo de Retenci√≥n";
            instructions = "Identifique las parejas de formas geom√©tricas ocultas bajo los paneles.";
            
            let cardsData = [...shapes, ...shapes].sort(() => Math.random() - 0.5);
            const grid = document.createElement('div');
            grid.className = 'grid-memory';
            
            let flipped = [];
            let matches = 0;

            cardsData.forEach((svgContent, index) => {
                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = svgContent;
                card.onclick = () => {
                    if (card.classList.contains('flipped') || flipped.length === 2) return;
                    card.classList.add('flipped');
                    flipped.push(card);

                    if (flipped.length === 2) {
                        if (flipped[0].innerHTML === flipped[1].innerHTML) {
                            matches++;
                            flipped = [];
                            if (matches === shapes.length) setTimeout(() => showFeedback(true, "M√≥dulo completado con √©xito."), 600);
                        } else {
                            setTimeout(() => {
                                flipped.forEach(c => c.classList.remove('flipped'));
                                flipped = [];
                            }, 1000);
                        }
                    }
                };
                grid.appendChild(card);
            });
            gameArea.appendChild(grid);
        }

        function setupAgilityGame() {
            gameTitle.innerText = "An√°lisis de Magnitud";
            instructions = "Seleccione el valor num√©rico con mayor magnitud de los presentados.";
            
            const n1 = Math.floor(Math.random() * 90) + 10;
            let n2 = Math.floor(Math.random() * 90) + 10;
            while(n1 === n2) n2 = Math.floor(Math.random() * 90) + 10;

            [n1, n2].forEach(num => {
                const btn = document.createElement('button');
                btn.className = 'btn-large';
                btn.style.height = '150px';
                btn.style.fontSize = '80px';
                btn.style.fontFamily = 'monospace';
                btn.innerText = num;
                btn.onclick = () => {
                    if (num === Math.max(n1, n2)) showFeedback(true, "An√°lisis correcto.");
                    else showFeedback(false, "El valor seleccionado es menor. Intente de nuevo.");
                };
                gameArea.appendChild(btn);
            });
        }

        function setupAssociationGame() {
            gameTitle.innerText = "L√≥gica y Categor√≠a";
            const challenges = [
                { q: "¬øCu√°l de estos elementos pertenece a un TALLER?", opts: ["Llave Inglesa", "Microondas", "Almohada"], win: 0 },
                { q: "¬øCu√°l es una herramienta de COMUNICACI√ìN?", opts: ["Reloj", "Tel√©fono", "Martillo"], win: 1 },
                { q: "Si hablamos de NAVEGACI√ìN, ¬øqu√© es √∫til?", opts: ["Br√∫jula", "Espejo", "Escalera"], win: 0 }
            ];
            const ch = challenges[Math.floor(Math.random() * challenges.length)];
            instructions = ch.q;

            const qText = document.createElement('p');
            qText.style.fontSize = '26px';
            qText.style.marginBottom = '30px';
            qText.innerText = ch.q;
            gameArea.appendChild(qText);

            ch.opts.forEach((opt, idx) => {
                const btn = document.createElement('button');
                btn.className = 'btn-large';
                btn.innerText = opt;
                btn.onclick = () => {
                    if (idx === ch.win) showFeedback(true, "Asociaci√≥n l√≥gica verificada.");
                    else showFeedback(false, "La relaci√≥n no es correcta. Pruebe otra opci√≥n.");
                };
                gameArea.appendChild(btn);
            });
        }

        function showFeedback(success, msg) {
            window.speechSynthesis.cancel();
            feedbackContent.innerHTML = success ? 
                `<div class="status-icon" style="color:var(--success)">‚óè</div><h1 style="color:var(--success)">Confirmado</h1><p>${msg}</p>` :
                `<div class="status-icon" style="color:var(--accent-color)">‚óã</div><h1>Revisi√≥n</h1><p>${msg}</p>`;
            
            const voice = new SpeechSynthesisUtterance(msg);
            voice.lang = 'es-ES';
            window.speechSynthesis.speak(voice);

            overlay.style.display = 'flex';
            feedbackBtn.innerText = success ? "Volver al men√∫" : "Reiniciar ejercicio";
            feedbackBtn.onclick = () => {
                overlay.style.display = 'none';
                if (success) showHomeScreen();
                else startGame(currentGame);
            };
        }
    </script>
</body>
</html>
